{"version":3,"sources":["webpack/bootstrap cf659eeec3f3f6efc5df","D:\\_src\\pydt\\api\\lib\\config.ts","external \"lodash\"","external \"winston\"","external \"tsoa\"","D:\\_src\\pydt\\api\\lib\\ioc.ts","D:\\_src\\pydt\\api\\api\\framework\\index.ts","D:\\_src\\pydt\\api\\api\\router.ts","external \"express\"","D:\\_src\\pydt\\api\\api\\_gen\\routes\\routes.ts","external \"inversify\"","external \"inversify-binding-decorators\"","D:\\_src\\pydt\\api\\api\\controllers\\authController.ts","D:\\_src\\pydt\\api\\api\\framework\\errorResponse.ts","D:\\_src\\pydt\\api\\api\\framework\\httpRequest.ts","D:\\_src\\pydt\\api\\api\\framework\\httpResponse.ts","D:\\_src\\pydt\\api\\api\\framework\\httpResponseError.ts","D:\\_src\\pydt\\api\\lib\\steamUtil.ts","external \"passport\"","external \"passport-steam\"","D:\\_src\\pydt\\api\\lib\\dynamoose\\userRepository.ts","D:\\_src\\pydt\\api\\lib\\dynamoose\\common.ts","external \"dynamoose\"","D:\\_src\\pydt\\api\\lib\\auth\\jwtUtil.ts","external \"jsonwebtoken\"","external \"querystring\"","D:\\_src\\pydt\\api\\lib\\logging.ts","external \"winston-transport-rollbar\"","D:\\_src\\pydt\\api\\api\\_gen\\swagger\\swagger.json"],"names":[],"mappings":"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","file":"api/router.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 6);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap cf659eeec3f3f6efc5df","export class Config {\r\n  public static activeStage() {\r\n    return process.env.SERVERLESS_STAGE as string;\r\n  }\r\n  public static resourcePrefix() {\r\n    return process.env.RESOURCE_PREFIX as string;\r\n  }\r\n  public static webUrl() {\r\n    return process.env.WEB_URL as string;\r\n  }\r\n  public static jwtSecret() {\r\n    return process.env.JWT_SECRET as string;\r\n  }\r\n  public static discourseApiKey() {\r\n    return process.env.DISCOURSE_API_KEY as string;\r\n  }\r\n  public static steamApiKey() {\r\n    return process.env.STEAM_API_KEY as string;\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./lib/config.ts","module.exports = require(\"lodash\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lodash\"\n// module id = 1\n// module chunks = 0","module.exports = require(\"winston\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"winston\"\n// module id = 2\n// module chunks = 0","module.exports = require(\"tsoa\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"tsoa\"\n// module id = 3\n// module chunks = 0","import { Container, inject, interfaces } from 'inversify';\r\nimport { autoProvide, makeFluentProvideDecorator, makeProvideDecorator } from 'inversify-binding-decorators';\r\n\r\nconst iocContainer = new Container();\r\n\r\nconst provide = makeProvideDecorator(iocContainer);\r\nconst fluentProvider = makeFluentProvideDecorator(iocContainer);\r\n\r\nconst provideNamed = (\r\n  identifier: string | symbol | interfaces.Newable<any> | interfaces.Abstract<any>,\r\n  name: string,\r\n) => {\r\n  return fluentProvider(identifier)\r\n    .whenTargetNamed(name)\r\n    .done();\r\n};\r\n\r\nconst provideSingleton = (\r\n  identifier: string | symbol | interfaces.Newable<any> | interfaces.Abstract<any>,\r\n) => {\r\n  return fluentProvider(identifier)\r\n    .inSingletonScope()\r\n    .done();\r\n};\r\n\r\nexport { iocContainer, autoProvide, provide, provideSingleton, provideNamed, inject };\r\n\n\n\n// WEBPACK FOOTER //\n// ./lib/ioc.ts","export * from './errorResponse';\r\nexport * from './httpRequest';\r\nexport * from './httpResponse';\r\nexport * from './httpResponseError';\r\nexport * from './lambdaProxyEvent';\r\nexport * from './lambdaProxyCallback';\r\nexport * from './lambdaProxyPayload';\r\n\n\n\n// WEBPACK FOOTER //\n// ./api/framework/index.ts","import { Router } from 'express';\r\nimport { RegisterRoutes } from './_gen/routes/routes';\r\nimport { ErrorResponse, HttpRequest, HttpResponse, HttpResponseError, LambdaProxyEvent, LambdaProxyCallback } from './framework';\r\nimport { configureLogging } from '../lib/logging';\r\nimport * as winston from 'winston';\r\n\r\nconfigureLogging();\r\n\r\nconst router = Router();\r\n\r\nrouter.get('/swagger.json', (req, res) => {\r\n  res.status(200).json(require('./_gen/swagger/swagger.json'));\r\n});\r\n\r\ntype middlewareExec = ((request: HttpRequest, response: HttpResponse, next: any) => void);\r\n\r\nfunction methodHandler(method: string) {\r\n  return function (route: string, ...routeExecs: middlewareExec[]) {\r\n    router[method](route, (req, res) => {\r\n      winston.info(`Found route ${route}`);\r\n\r\n      const runNext = (runExecs: middlewareExec[]) => {\r\n        const curExec: middlewareExec = runExecs[0];\r\n\r\n        curExec(req, res, (err) => {\r\n          if (err) {\r\n            let status = 500;\r\n            let message = 'There was an error processing your request.';\r\n            let logError = true;\r\n\r\n            if (err.constructor.name === 'InvalidRequestException') {\r\n              // TODO: These probably shouldn't go to an end user, they come from TSOA and look like:\r\n              // 'landingPageURL' is a required undefined parameter.\r\n              status = err.status;\r\n              message = err.message;\r\n              logError = false;\r\n            }\r\n\r\n            if (err instanceof HttpResponseError) {\r\n              status = err.statusCode;\r\n              message = err.message;\r\n              logError = false;\r\n            }\r\n\r\n            if (logError) {\r\n              winston.error(err);\r\n            }\r\n\r\n            res.status(status).json(new ErrorResponse(message));\r\n          } else if (runExecs.length > 1) {\r\n            runNext(runExecs.slice(1));\r\n          }\r\n        });\r\n      };\r\n\r\n      runNext(routeExecs);\r\n    });\r\n  };\r\n}\r\n\r\nconst mockApp = {\r\n  delete: methodHandler('delete'),\r\n  get: methodHandler('get'),\r\n  patch: methodHandler('patch'),\r\n  post: methodHandler('post'),\r\n  put: methodHandler('put')\r\n};\r\n\r\nRegisterRoutes(mockApp);\r\n\r\nexport function handler(event: LambdaProxyEvent, context, callback: LambdaProxyCallback) {\r\n  // Typeorm will prevent the event loop from emptying\r\n  context.callbackWaitsForEmptyEventLoop = false;\r\n\r\n  winston.info(`handling ${event.httpMethod} ${event.path}`);\r\n\r\n  const response = new HttpResponse(callback);\r\n\r\n  if (event.httpMethod.toLowerCase() === 'options') {\r\n    response.status(200).end();\r\n  } else {\r\n    (router as any).handle(new HttpRequest(event, response), response, err => {\r\n      winston.info(`404 for ${event.httpMethod} ${event.path}`);\r\n      response.status(404).json(new ErrorResponse('Not Found'));\r\n    });\r\n  }\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./api/router.ts","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 7\n// module chunks = 0","/* tslint:disable */\r\nimport { Controller, ValidateParam, FieldErrors, ValidateError, TsoaRoute } from 'tsoa';\r\nimport { iocContainer } from './../../../lib/ioc';\r\nimport { AuthController } from './../../controllers/authController';\r\nimport { expressAuthentication } from './../../../lib/auth/expressAuthentication';\r\n\r\nconst models: TsoaRoute.Models = {\r\n    \"AuthenticateResponse\": {\r\n        \"properties\": {\r\n            \"redirectURL\": { \"dataType\": \"string\", \"required\": true },\r\n        },\r\n    },\r\n    \"SteamProfile\": {\r\n        \"properties\": {\r\n            \"steamid\": { \"dataType\": \"string\", \"required\": true },\r\n            \"personaname\": { \"dataType\": \"string\", \"required\": true },\r\n            \"profileurl\": { \"dataType\": \"string\", \"required\": true },\r\n            \"avatar\": { \"dataType\": \"string\", \"required\": true },\r\n            \"avatarmedium\": { \"dataType\": \"string\", \"required\": true },\r\n            \"avatarfull\": { \"dataType\": \"string\", \"required\": true },\r\n        },\r\n    },\r\n    \"ValidateResponse\": {\r\n        \"properties\": {\r\n            \"token\": { \"dataType\": \"string\", \"required\": true },\r\n            \"steamProfile\": { \"ref\": \"SteamProfile\", \"required\": true },\r\n        },\r\n    },\r\n};\r\n\r\nexport function RegisterRoutes(app: any) {\r\n    app.get('/auth/steam',\r\n        function(request: any, response: any, next: any) {\r\n            const args = {\r\n            };\r\n\r\n            let validatedArgs: any[] = [];\r\n            try {\r\n                validatedArgs = getValidatedArgs(args, request);\r\n            } catch (err) {\r\n                return next(err);\r\n            }\r\n\r\n            const controller = iocContainer.get<AuthController>(AuthController);\r\n\r\n\r\n            const promise = controller.authenticate.apply(controller, validatedArgs);\r\n            promiseHandler(controller, promise, response, next);\r\n        });\r\n    app.get('/auth/steam/validate',\r\n        function(request: any, response: any, next: any) {\r\n            const args = {\r\n                request: { \"in\": \"request\", \"name\": \"request\", \"required\": true, \"dataType\": \"object\" },\r\n            };\r\n\r\n            let validatedArgs: any[] = [];\r\n            try {\r\n                validatedArgs = getValidatedArgs(args, request);\r\n            } catch (err) {\r\n                return next(err);\r\n            }\r\n\r\n            const controller = iocContainer.get<AuthController>(AuthController);\r\n\r\n\r\n            const promise = controller.validate.apply(controller, validatedArgs);\r\n            promiseHandler(controller, promise, response, next);\r\n        });\r\n\r\n\r\n    function promiseHandler(controllerObj: any, promise: any, response: any, next: any) {\r\n        return Promise.resolve(promise)\r\n            .then((data: any) => {\r\n                let statusCode;\r\n                if (controllerObj instanceof Controller) {\r\n                    const controller = controllerObj as Controller\r\n                    const headers = controller.getHeaders();\r\n                    Object.keys(headers).forEach((name: string) => {\r\n                        response.set(name, headers[name]);\r\n                    });\r\n\r\n                    statusCode = controller.getStatus();\r\n                }\r\n\r\n                if (data) {\r\n                    response.status(statusCode | 200).json(data);\r\n                } else {\r\n                    response.status(statusCode | 204).end();\r\n                }\r\n            })\r\n            .catch((error: any) => next(error));\r\n    }\r\n\r\n    function getValidatedArgs(args: any, request: any): any[] {\r\n        const fieldErrors: FieldErrors = {};\r\n        const values = Object.keys(args).map((key) => {\r\n            const name = args[key].name;\r\n            switch (args[key].in) {\r\n                case 'request':\r\n                    return request;\r\n                case 'query':\r\n                    return ValidateParam(args[key], request.query[name], models, name, fieldErrors);\r\n                case 'path':\r\n                    return ValidateParam(args[key], request.params[name], models, name, fieldErrors);\r\n                case 'header':\r\n                    return ValidateParam(args[key], request.header(name), models, name, fieldErrors);\r\n                case 'body':\r\n                    return ValidateParam(args[key], request.body, models, name, fieldErrors, name + '.');\r\n                case 'body-prop':\r\n                    return ValidateParam(args[key], request.body[name], models, name, fieldErrors, 'body.');\r\n            }\r\n        });\r\n        if (Object.keys(fieldErrors).length > 0) {\r\n            throw new ValidateError(fieldErrors, '');\r\n        }\r\n        return values;\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./api/_gen/routes/routes.ts","module.exports = require(\"inversify\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"inversify\"\n// module id = 9\n// module chunks = 0","module.exports = require(\"inversify-binding-decorators\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"inversify-binding-decorators\"\n// module id = 10\n// module chunks = 0","import { HttpRequest, HttpResponseError } from '../framework';\r\nimport { Get, Route, Request } from 'tsoa';\r\nimport { provideSingleton } from '../../lib/ioc';\r\nimport { steamPassport } from '../../lib/steamUtil';\r\nimport { User, SteamProfile } from '../../lib/models';\r\nimport { userRepository } from '../../lib/dynamoose/userRepository';\r\nimport { JwtUtil } from '../../lib/auth/jwtUtil';\r\nimport * as winston from 'winston';\r\nimport * as querystring from 'querystring';\r\n\r\n@Route('auth')\r\n@provideSingleton(AuthController)\r\nexport class AuthController {\r\n  @Get('steam')\r\n  public authenticate(): Promise<AuthenticateResponse> {\r\n    return new Promise((resolve, reject) => {\r\n      let location = null;\r\n\r\n      // Since passport expects to work with something like express,\r\n      // mock the req/res/next middleware format...\r\n      const req = {};\r\n      const res = {\r\n        setHeader: (key, value) => {\r\n          if (key === 'Location') {\r\n            location = value;\r\n          }\r\n        },\r\n        end: () => {\r\n          resolve({\r\n            redirectURL: location\r\n          });\r\n        }\r\n      };\r\n      const next = () => {\r\n        // Nothing to do here\r\n      };\r\n\r\n      steamPassport.authenticate('steam', (err, user, info) => {\r\n        if (err) {\r\n          reject(err);\r\n        } else {\r\n          winston.info('Callback called without error?', user, info);\r\n        }\r\n      })(req, res, next);\r\n    });\r\n  }\r\n\r\n  @Get('steam/validate')\r\n  public validate(@Request() request: HttpRequest): Promise<ValidateResponse> {\r\n    return new Promise((resolve, reject) => {\r\n      const req = {\r\n        query: request.query,\r\n        url: '/blah?' + querystring.stringify(request.query)\r\n      };\r\n      const res = {\r\n        setHeader: (key, value) => {\r\n          if (key === 'Location') {\r\n            // We shouldn't get here in validate...\r\n            reject(new HttpResponseError(400, 'Bad Request'));\r\n          }\r\n        }\r\n      };\r\n      const next = () => {\r\n        // We shouldn't get here in validate...\r\n        reject(new HttpResponseError(400, 'Bad Request'));\r\n      };\r\n\r\n      steamPassport.authenticate('steam', (err, user, info) => {\r\n        if (err) {\r\n          reject(err);\r\n        } else {\r\n          userRepository.get(user.profile.id).then(dbUser => {\r\n            if (!dbUser) {\r\n              dbUser = {\r\n                steamId: user.profile.id\r\n              } as User;\r\n            }\r\n\r\n            const steamProfile = user.profile._json as SteamProfile;\r\n\r\n            dbUser.displayName = user.profile.displayName;\r\n            dbUser.avatarSmall = steamProfile.avatar;\r\n            dbUser.avatarMedium = steamProfile.avatarmedium;\r\n            dbUser.avatarFull = steamProfile.avatarfull;\r\n            return userRepository.saveVersioned(dbUser);\r\n          }).then(() => {\r\n            resolve({\r\n              token: JwtUtil.createToken({ steamId: user.profile.id }),\r\n              steamProfile: user.profile._json\r\n            });\r\n          }).catch(perr => {\r\n            reject(perr);\r\n          });\r\n        }\r\n      })(req, res, next);\r\n    });\r\n  }\r\n}\r\n\r\nexport interface AuthenticateResponse {\r\n  redirectURL: string;\r\n}\r\n\r\nexport interface ValidateResponse {\r\n  token: string;\r\n  steamProfile: SteamProfile;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./api/controllers/authController.ts","export class ErrorResponse {\r\n  constructor(public message: string) {\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./api/framework/errorResponse.ts","import { LambdaProxyEvent } from './lambdaProxyEvent';\r\nimport { FullJwtPayload } from '../../lib/auth/jwtPayload';\r\nimport { HttpResponse } from './httpResponse';\r\nimport * as _ from 'lodash';\r\n\r\nexport class HttpRequest {\r\n  public body: any;\r\n  public headers: any;\r\n  public method: string;\r\n  public params: any;\r\n  public query: any;\r\n  public user: FullJwtPayload;\r\n  public url: string;\r\n\r\n  // HACK: We pass in response here to work around limitations in the TSOA framework,\r\n  // when they make it easier to create your own templates for authentication we can\r\n  // revisit this.\r\n  constructor(event: LambdaProxyEvent, public response: HttpResponse) {\r\n    if (event.body) {\r\n      this.body = JSON.parse(event.body);\r\n    }\r\n\r\n    this.headers = _.reduce(event.headers || {}, (result, value, key) => {\r\n      result[key.toLowerCase()] = value;\r\n      return result;\r\n    }, {});\r\n    this.method = event.httpMethod;\r\n    this.params = event.pathParameters;\r\n    this.query = event.queryStringParameters;\r\n    this.url = event.path;\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./api/framework/httpRequest.ts","import { LambdaProxyCallback } from './lambdaProxyCallback';\r\n\r\nexport class HttpResponse {\r\n  private data: any;\r\n  private statusCode: number;\r\n  private headers = {\r\n    'Access-Control-Allow-Headers': 'Content-Type,api-key',\r\n    'Access-Control-Expose-Headers': 'api-key',\r\n    'Access-Control-Allow-Origin': '*',\r\n    'Access-Control-Allow-Methods': 'GET, HEAD, POST, PUT, DELETE, OPTIONS, PATCH'\r\n  };\r\n\r\n  constructor(private callback: LambdaProxyCallback) {\r\n  }\r\n\r\n  public json(data: any) {\r\n    this.data = data;\r\n    this.end();\r\n  }\r\n\r\n  public status(code: number) {\r\n    this.statusCode = code;\r\n    return this;\r\n  }\r\n\r\n  public addHeader(name: string, value: string) {\r\n    this.headers[name] = value;\r\n  }\r\n\r\n  public end() {\r\n    if (this.callback) {\r\n      this.callback(null, {\r\n        body: JSON.stringify(this.data),\r\n        headers: this.headers,\r\n        statusCode: this.statusCode,\r\n      });\r\n\r\n      this.callback = null;\r\n    }\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./api/framework/httpResponse.ts","export class HttpResponseError extends Error {\r\n  public static createUnauthorized() {\r\n    return new HttpResponseError(401, 'Unauthorized');\r\n  }\r\n\r\n  constructor(public statusCode: number, message: string) {\r\n    super(message);\r\n\r\n    // Set the prototype explicitly:\r\n    // tslint:disable-next-line\r\n    // https://github.com/Microsoft/TypeScript-wiki/blob/master/Breaking-Changes.md#extending-built-ins-like-error-array-and-map-may-no-longer-work\r\n    Object.setPrototypeOf(this, HttpResponseError.prototype);\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./api/framework/httpResponseError.ts","import { Config } from './config';\r\nimport * as passport from 'passport';\r\nimport * as passportSteam from 'passport-steam';\r\n\r\npassport.use(\r\n  new passportSteam.Strategy({\r\n    returnURL: Config.webUrl() + '/steamreturn',\r\n    realm: Config.webUrl(),\r\n    apiKey: Config.steamApiKey()\r\n  },\r\n  function(identifier, profile, done) {\r\n    done(null, {\r\n      identifier: identifier,\r\n      profile: profile\r\n    });\r\n  })\r\n);\r\n\r\nexport const steamPassport = passport;\r\n\n\n\n// WEBPACK FOOTER //\n// ./lib/steamUtil.ts","module.exports = require(\"passport\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"passport\"\n// module id = 17\n// module chunks = 0","module.exports = require(\"passport-steam\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"passport-steam\"\n// module id = 18\n// module chunks = 0","import { dynamoose, IRepository } from './common';\r\nimport { Config } from '../config';\r\nimport { User } from '../models/user';\r\nimport { Game } from '../models/game';\r\nimport * as _ from 'lodash';\r\n\r\nexport interface IUserRepository extends IRepository<string, User> {\r\n  createS3GameCacheKey(steamId: string): string;\r\n  getUsersForGame(game: Game): Promise<User[]>;\r\n}\r\n\r\nexport const userRepository = dynamoose.createVersionedModel(Config.resourcePrefix() + 'user', {\r\n  steamId: {\r\n    type: String,\r\n    hashKey: true\r\n  },\r\n  displayName: {\r\n    type: String,\r\n    required: true\r\n  },\r\n  avatarSmall: String,\r\n  avatarMedium: String,\r\n  avatarFull: String,\r\n  emailAddress: String,\r\n  activeGameIds: [String],\r\n  inactiveGameIds: [String],\r\n  turnsPlayed: {\r\n    type: Number,\r\n    default: 0\r\n  },\r\n  turnsSkipped: {\r\n    type: Number,\r\n    default: 0\r\n  },\r\n  timeTaken: {\r\n    type: Number,\r\n    default: 0\r\n  },\r\n  fastTurns: {\r\n    type: Number,\r\n    default: 0\r\n  },\r\n  slowTurns: {\r\n    type: Number,\r\n    default: 0\r\n  }\r\n}) as IUserRepository;\r\n\r\nuserRepository.createS3GameCacheKey = (steamId) => {\r\n  return steamId + '/' + 'gameCache.json';\r\n};\r\n\r\nuserRepository.getUsersForGame = game => {\r\n  const steamIds = _.compact(_.map(game.players, 'steamId'));\r\n  return userRepository.batchGet(steamIds).then(users => {\r\n    // make sure they're sorted correctly...\r\n    const playersWithSteamIds = _.filter(game.players, player => {\r\n      return !!player.steamId;\r\n    });\r\n\r\n    return _.map(playersWithSteamIds, player => {\r\n      return _.find(users, user => {\r\n        return user.steamId === player.steamId;\r\n      });\r\n    });\r\n  });\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./lib/dynamoose/userRepository.ts","import * as baseDynamoose from 'dynamoose';\r\nimport * as _ from 'lodash';\r\n\r\nbaseDynamoose.setDefaults({\r\n  create: false\r\n});\r\n\r\nexport interface IRepository<TKey, TEntity> {\r\n  get(id: TKey): Promise<TEntity>;\r\n  batchGet(ids: TKey[]): Promise<TEntity[]>;\r\n  saveVersioned(model: TEntity): Promise<TEntity>;\r\n}\r\n\r\nexport const dynamoose = _.merge(baseDynamoose, {\r\n  createVersionedModel: (name, schema) => {\r\n    schema.version = {\r\n      type: Number,\r\n      default: 0,\r\n      set: function(value) {\r\n        return value + 1\r\n      }\r\n    };\r\n\r\n    const model = dynamoose.model(name, new dynamoose.Schema(schema, { timestamps: true }));\r\n\r\n    model.saveVersioned = (m) => {\r\n      return m.save({\r\n        condition: 'attribute_not_exists(version) OR version = :version',\r\n        conditionValues: { version: (model.version || 0) - 1 }\r\n      });\r\n    };\r\n\r\n    return model;\r\n  }\r\n});\r\n\n\n\n// WEBPACK FOOTER //\n// ./lib/dynamoose/common.ts","module.exports = require(\"dynamoose\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"dynamoose\"\n// module id = 21\n// module chunks = 0","import * as jwt from 'jsonwebtoken';\r\nimport { PydtJwtPayload, FullJwtPayload } from './jwtPayload';\r\nimport { Config } from '../config';\r\n\r\nexport namespace JwtUtil {\r\n  export function createToken(payload: PydtJwtPayload): string {\r\n    return jwt.sign(payload, Config.jwtSecret());\r\n  }\r\n\r\n  export function parseToken(token: string): FullJwtPayload {\r\n    return jwt.verify(token, Config.jwtSecret()) as FullJwtPayload;\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./lib/auth/jwtUtil.ts","module.exports = require(\"jsonwebtoken\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jsonwebtoken\"\n// module id = 23\n// module chunks = 0","module.exports = require(\"querystring\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"querystring\"\n// module id = 24\n// module chunks = 0","import * as winston from 'winston';\r\nimport wr from 'winston-transport-rollbar';\r\nimport { Config } from './config';\r\n\r\nexport function configureLogging() {\r\n  winston.configure({\r\n    exitOnError: false,\r\n    handleExceptions: true,\r\n    transports: [\r\n      new winston.transports.Console()\r\n    ]\r\n  });\r\n\r\n  // wr isn't anything because of the weird way this transport is designed, but we need to\r\n  // check for it to prevent webpack from tree-shaking :(\r\n  if (!wr && Config.activeStage() && Config.activeStage() !== 'dev') {\r\n    winston.add((winston.transports as any).Rollbar, {\r\n      rollbarAccessToken: 'cc75ab4c6093419aa3b026df58dc8996',\r\n      rollbarConfig: {\r\n        environment: Config.activeStage()\r\n      },\r\n      level: 'warn'\r\n    });\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./lib/logging.ts","module.exports = require(\"winston-transport-rollbar\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"winston-transport-rollbar\"\n// module id = 26\n// module chunks = 0","module.exports = {\"basePath\":\"/\",\"consumes\":[\"application/json\"],\"definitions\":{\"AuthenticateResponse\":{\"properties\":{\"redirectURL\":{\"type\":\"string\"}},\"required\":[\"redirectURL\"],\"type\":\"object\"},\"SteamProfile\":{\"properties\":{\"steamid\":{\"type\":\"string\"},\"personaname\":{\"type\":\"string\"},\"profileurl\":{\"type\":\"string\"},\"avatar\":{\"type\":\"string\"},\"avatarmedium\":{\"type\":\"string\"},\"avatarfull\":{\"type\":\"string\"}},\"required\":[\"steamid\",\"personaname\",\"profileurl\",\"avatar\",\"avatarmedium\",\"avatarfull\"],\"type\":\"object\"},\"ValidateResponse\":{\"properties\":{\"token\":{\"type\":\"string\"},\"steamProfile\":{\"$ref\":\"#/definitions/SteamProfile\"}},\"required\":[\"token\",\"steamProfile\"],\"type\":\"object\"}},\"info\":{\"title\":\"serverless-api\",\"version\":\"1.0.0\"},\"paths\":{\"/auth/steam\":{\"get\":{\"operationId\":\"AuthAuthenticate\",\"produces\":[\"application/json\"],\"responses\":{\"200\":{\"description\":\"Ok\",\"schema\":{\"$ref\":\"#/definitions/AuthenticateResponse\"}}},\"security\":[],\"parameters\":[]}},\"/auth/steam/validate\":{\"get\":{\"operationId\":\"AuthValidate\",\"produces\":[\"application/json\"],\"responses\":{\"200\":{\"description\":\"Ok\",\"schema\":{\"$ref\":\"#/definitions/ValidateResponse\"}}},\"security\":[],\"parameters\":[]}}},\"produces\":[\"application/json\"],\"swagger\":\"2.0\",\"securityDefinitions\":{\"api_key\":{\"type\":\"apiKey\",\"name\":\"api-key\",\"in\":\"header\"},\"basic_auth_internal\":{\"type\":\"basic\"}},\"host\":\"localhost:3000\"}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./api/_gen/swagger/swagger.json\n// module id = 27\n// module chunks = 0"],"sourceRoot":""}